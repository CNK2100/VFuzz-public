

> [Vulnerability description]

Z-Wave  controller supporting security 2 (S2) encryption with chipset 500 are vulnerable to improper authorization (CWE-285)
vulnerability, which may allow a remote, unauthenticated attacker to inject an invalid device Node information (NIF) frame 
that modifies the valid NIF stored in the controller memory. This causes denial of service (DoS) on a  target Z-Wave slave device
implementing Security 0 (S0) encryption.   Affected products include  Z-Wave controllers with 500 chipset. T
his vulnerability is due the lack of authenticating the sender and unencrypted NIF frames.  
This vulnerability can be fixed by authenticating the sender and mandate the encryption of NIF frame. 

> [Additional Information]

With the use of tools and transceivers that can decode Z-Wave frame( e.g., Scapy-radio with HackRF One;
Yard Stick One; RFCat ; RTL-SDR; Zniffer with Sigma UZB) an attacker sniffs and captures any Z-Wave 
communication of a target Z-Wave smart home. Then he retrieves the Z-Wave HomeID and NodeID of devices 
that are transmiting packets in the network. With the knowledge of the HomeID, the attacker can brute force 
the Z-Wave network to know all remaining available smart devices in the network. This is achieved by sending
to all possible Z-Wave node (2 to 232) either these Z-Wave frames: No Operation (NOP), SWITCH_BINARY_GET,
or Node Information (NIF) to get the acknowledgement (ACK) from non-authenticated devices. 
For authenticated devices the attacker will send Node Information (NIF), SECURITY_NONCE_GET, 
and SECURITY_2_NONCE_GET. From this ACK the attacker retrieves the node ID of devices that responded and 
their NIF capabilities. With the knowledge of the Z-Wave HomeID, NIF, and NodeID of the device, 
the attacker crafts a Z-Wave packet with a desired command as payload and sends it to the target device 
by using a customized Z-Wave packet management software and  HackRF One, or  Yard Stick One,  RFCat, or CC1110. 
The device will accept and validate the packet. 
------------------------------------------

> [How does an attacker exploit this vulnerability ?]

Attacker and target device need to be within a range of 30 meters. 
The range can be increased by using an advanced Software-Defined Radio (SDR) hardware.
------------------------------------------

> [What is the impact of this vulnerability ?]

 Partial denial of service (DoS) on slave S0 devices.
------------------------------------------

> [Vendor of Product]
  Sigma Design and Silicon Labs
------------------------------------------

> [Affected Product Code Base]
  Z Wave S2 devices with chipsets 500 Series.
------------------------------------------

> [Affected Component]
  Improper authorization (CWE-285) on controller's memory that store devices' NIF data.
------------------------------------------
 
> [Attack Type]
  Proximate remote attack
------------------------------------------

>[Impact Denial of Service]
 Denial of Service to reach the slave S0 device via the controller.
------------------------------------------

> [Attack Vectors]
  By crafting an invalid Z-Wave S0 device's NIF frame and sending it to the controller for memory update.  
------------------------------------------
 
> [Reference]
  https://www.silabs.com/products/development-tools/software/z-wave
  https://github.com/OpenZWave
  https://www.silabs.com/documents/login/miscellaneous/SDS13784-Z-Wave-Network-Protocol-Command-Class-Specification.pdf
------------------------------------------ 
> [Discoverer]
  CNK CCSLab
